#!/bin/sh

# ============================
#  ğŸš€ PakaWrt Installer Menu
#  ğŸ“¦ Platform: AW1000 / AArch64
#  ğŸ§‘â€ğŸ’» Author: Pakalolo Waraso
#  ============================

# Terminal Colors
CYAN="\033[0;36m"
BLUE="\033[1;34m"
GREEN="\033[1;32m"
YELLOW="\033[1;33m"
NC="\033[0m" # No Color

# Installer URLs
URL_OWRT="http://abidarwi.sh/pakafirmware_owrt-final.sh"
URL_NSS="http://abidarwi.sh/pakanss30042025.sh"
URL_NSS_LITE="http://abidarwi.sh/pakanss08052025.sh"

# Show branding
show_branding() {
    printf "${CYAN}"
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘     ğŸš€ PAKAWRT FIRMWARE - AW1000 ğŸš€     â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    printf "${BLUE}ğŸ§‘â€ğŸ’» Author        : Pakalolo Waraso${NC}\n"
    printf "${BLUE}ğŸ’¬ Special Thanks : Awiks Telegram Group${NC}\n"
    printf "${BLUE}ğŸ”§ Maintainer     : https://github.com/BootLoopLover${NC}\n"
    printf "${CYAN}===========================================${NC}\n"
}

# Check dependencies
for cmd in wget tar opkg; do
    if ! command -v "$cmd" >/dev/null 2>&1; then
        echo "âŒ Error: Perintah '$cmd' tidak tersedia. Harap install terlebih dahulu."
        exit 1
    fi
done

# Main menu
while true; do
    clear
    show_branding
    echo ""
    echo "ğŸ› ï¸  ========== PakaWrt Firmware Menu ========== ğŸ› ï¸"
    echo "1ï¸âƒ£  Install OpenWrt 24.10.0 (Vanilla)"
    echo "2ï¸âƒ£  Install NSS Build (30 April 2025)"
    echo "3ï¸âƒ£  Install NSS Lite Build (8 Mei 2025)"
    echo "4ï¸âƒ£  Keluar dari menu"
    echo "==========================================="
    printf "ğŸ‘‰ Pilih opsi [1-4]: "
    read -r choice

    case "$choice" in
        1)
            clear
            show_branding
            echo "==========================================="
            echo "ğŸ§© Firmware: OpenWrt Vanilla"
            echo "==========================================="
            echo "ğŸ§ Kernel     : 6.6.73"
            echo "ğŸ§µ Branch     : v24.10.0"
            echo "âš™ï¸ Developer  : Pakalolo"
            echo "ğŸ“¦ Platform   : AW1000 / aarch64"
            echo "==========================================="
            echo "ğŸ” Fitur:"
            echo "  - ğŸŒ VnStat untuk monitoring trafik"
            echo "  - ğŸ“¶ 3G Info, AT Cmd, Band Lock, SMS"
            echo "  - ğŸ” Passwall 4.6.68, Tailscale VPN"
            echo "  - ğŸš« Adblocker (opsional)"
            echo "==========================================="
            echo ""
            read -n1 -r -p "ğŸ”„ Tekan enter untuk mulai instalasi..."
            wget -q -O installer "$URL_OWRT" && chmod +x installer && ./installer
            read -n1 -r -p "âœ… Tekan enter untuk kembali ke menu..." ;;
        2)
            clear
            show_branding
            echo "==========================================="
            echo "ğŸ§© Firmware: NSS Build"
            echo "==========================================="
            echo "ğŸ§ Kernel     : 6.6.79"
            echo "ğŸ§µ Branch     : v24.10-nss"
            echo "âš™ï¸ Developer  : Pakalolo"
            echo "ğŸ“¦ Platform   : AW1000 / aarch64"
            echo "==========================================="
            echo "ğŸ” Fitur:"
            echo "  - ğŸ“¡ AT Cmd, Band Lock, SMS Manager, QModem"
            echo "  - ğŸ” Passwall2, Internet Detector, Tailscale"
            echo "==========================================="
            echo ""
            read -n1 -r -p "ğŸ”„ Tekan enter untuk mulai instalasi..."
            wget -q -O installer "$URL_NSS" && chmod +x installer && ./installer
            read -n1 -r -p "âœ… Tekan enter untuk kembali ke menu..." ;;
        3)
            clear
            show_branding
            echo "==========================================="
            echo "ğŸ§© Firmware: NSS Lite Build"
            echo "==========================================="
            echo "ğŸ§ Kernel     : 6.6.86"
            echo "ğŸ§µ Branch     : v24.10-nss"
            echo "âš™ï¸ Developer  : Pakalolo"
            echo "ğŸ“¦ Platform   : AW1000 / aarch64"
            echo "==========================================="
            echo "ğŸ“Œ Catatan:"
            echo "  - ğŸ›¡ï¸ Support Libernet & TTL fix untuk Hotspot"
            echo "  - ğŸ“¶ QModem, Modem Info, Band Selector"
            echo "  - ğŸ” Passwall2"
            echo "==========================================="
            echo ""
            read -n1 -r -p "ğŸ”„ Tekan enter untuk mulai instalasi..."
            wget -q -O installer "$URL_NSS_LITE" && chmod +x installer && ./installer
            read -n1 -r -p "âœ… Tekan enter untuk kembali ke menu..." ;;
        4)
            echo -e "\nğŸ™ Terima kasih telah menggunakan PakaWrt!"
            exit 0 ;;
        *)
            echo "âš ï¸  Pilihan tidak valid! Silakan coba lagi."
            sleep 1 ;;
    esac
done
